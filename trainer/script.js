
// --- UI/Animation Logic (Designer Agent) ---
document.addEventListener('DOMContentLoaded', () => {const mobileMenuButton = document.getElementById('mobile-menu-button');const mobileMenu = document.getElementById('mobile-menu');if (mobileMenuButton && mobileMenu) {mobileMenuButton.addEventListener('click', () => {mobileMenu.classList.toggle('hidden');});}document.querySelectorAll('a[href^="#"]').forEach(anchor => {anchor.addEventListener('click', function (e) {e.preventDefault();document.querySelector(this.getAttribute('href')).scrollIntoView({behavior: 'smooth'});if (!mobileMenu.classList.contains('hidden')) {mobileMenu.classList.add('hidden');}});});});


// --- Backend/Data Logic (Integrator Agent) ---
if (!firebase.apps.length) {    const firebaseConfig = {        apiKey: "AIzaSyBtY_IrbV0TZLNvJ9Nr1h9UQFXygbO0zBQ",        authDomain: "landingpages-4d6a8.firebaseapp.com",        projectId: "landingpages-4d6a8",        storageBucket: "landingpages-4d6a8.firebasestorage.app",        messagingSenderId: "745990656140",        appId: "1:745990656140:web:367c261db9156b15f66ba9",        measurementId: "G-VJGLT3ZYJ6"    };    firebase.initializeApp(firebaseConfig);}const db = firebase.firestore();const auth = firebase.auth();const PAGE_DOC_ID = 'mr3jz9athyw12k7k0esb';let currentUser = null;async function updatePageMetrics(metric) {    try {        await db.collection("pages").doc(PAGE_DOC_ID).update({            [metric]: firebase.firestore.FieldValue.increment(1)        });    } catch (error) {        if (error.code === 'not-found') {            const initialData = {                views: 0,                clicks: 0,                leads: 0            };            initialData[metric] = 1;            await db.collection("pages").doc(PAGE_DOC_ID).set(initialData, { merge: true });        } else {            console.error("Error updating page metrics:", error);        }    }}auth.signInAnonymously().catch((error) => {    console.error("Error signing in anonymously:", error);});auth.onAuthStateChanged((user) => {    if (user) {        currentUser = user;        updatePageMetrics('views');        document.querySelectorAll('.track-link-click').forEach(link => {            link.addEventListener('click', () => {                updatePageMetrics('clicks');            });        });        const leadForm = document.getElementById('lead-form');        const submitBtn = document.getElementById('submit-btn');        const formContainer = leadForm ? leadForm.parentElement : null;        if (leadForm && submitBtn) {            leadForm.addEventListener('submit', async (event) => {                event.preventDefault();                if (!currentUser) {                    console.error("Form submission failed: User not authenticated.");                    alert("Authentication error. Please refresh the page and try again.");                    return;                }                const originalButtonText = submitBtn.textContent;                submitBtn.textContent = "Sending...";                submitBtn.disabled = true;                const data = {};                const inputs = leadForm.querySelectorAll('input, textarea');                inputs.forEach(input => {                    if (input.name) {                        data[input.name] = input.value;                    }                });                data.timestamp = firebase.firestore.FieldValue.serverTimestamp();                data.userId = currentUser.uid;                try {                    await db.collection("pages").doc(PAGE_DOC_ID).collection("leads").add(data);                    updatePageMetrics('leads');                    if (formContainer) {                        leadForm.style.display = 'none';                        const successMessage = document.createElement('div');                        successMessage.className = 'bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mt-8';                        successMessage.setAttribute('role', 'alert');                        successMessage.innerHTML = '<strong class="font-bold">Success!</strong><span class="block sm:inline"> Your consultation request has been sent. We\'ll be in touch shortly!</span>';                        formContainer.appendChild(successMessage);                    } else {                        leadForm.innerHTML = '<p class="text-green-600 font-bold">Thank you! Your request has been sent.</p>';                    }                } catch (error) {                    console.error("Error submitting lead:", error);                    alert("There was an error submitting your request. Please try again.");                } finally {                    submitBtn.textContent = originalButtonText;                    submitBtn.disabled = false;                }            });        }    } else {        currentUser = null;    }}); 