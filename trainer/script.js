
// --- UI/Animation Logic (Designer Agent) ---
document.addEventListener('DOMContentLoaded', () => {const mobileMenuButton = document.getElementById('mobile-menu-button');const mobileMenu = document.getElementById('mobile-menu');const navLinks = document.querySelectorAll('#mobile-menu a, .md\\:flex a');if (mobileMenuButton && mobileMenu) {mobileMenuButton.addEventListener('click', () => {mobileMenu.classList.toggle('hidden');});}navLinks.forEach(link => {link.addEventListener('click', function(e) {const href = this.getAttribute('href');if (href && href.startsWith('#')) {e.preventDefault();const targetId = href.substring(1);const targetElement = document.getElementById(targetId);if (targetElement) {if (!mobileMenu.classList.contains('hidden')) {mobileMenu.classList.add('hidden');}const headerOffset = document.querySelector('header').offsetHeight;const elementPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;const offsetPosition = elementPosition - headerOffset - 20;window.scrollTo({top: offsetPosition,behavior: "smooth"});}}});});});


// --- Backend/Data Logic (Integrator Agent) ---
const firebaseConfig = {apiKey: "AIzaSyBtY_IrbV0TZLNvJ9Nr1h9UQFXygbO0zBQ",authDomain: "landingpages-4d6a8.firebaseapp.com",projectId: "landingpages-4d6a8",storageBucket: "landingpages-4d6a8.firebasestorage.app",messagingSenderId: "745990656140",appId: "1:745990656140:web:367c261db9156b15f66ba9",measurementId: "G-VJGLT3ZYJ6"};const PAGE_DOC_ID = 'fchwn3nc2brmfyrua7waq';firebase.initializeApp(firebaseConfig);const db = firebase.firestore();let userId = null;async function updatePageMetrics(metricName) {if (!userId) {console.warn("User ID not available for metrics tracking. Skipping metric update.");return;}const pageRef = db.collection("pages").doc(PAGE_DOC_ID);try {await pageRef.update({[metricName]: firebase.firestore.FieldValue.increment(1),lastUpdated: firebase.firestore.FieldValue.serverTimestamp()});console.log(`Metric '${metricName}' updated successfully.`);} catch (error) {if (error.code === 'not-found') {const initialData = {createdAt: firebase.firestore.FieldValue.serverTimestamp(),lastUpdated: firebase.firestore.FieldValue.serverTimestamp()};initialData[metricName] = 1;await pageRef.set(initialData);console.log(`Page document created and metric '${metricName}' initialized.`);} else {console.error(`Error updating metric '${metricName}':`, error);}}}firebase.auth().signInAnonymously().then((result) => {userId = result.user.uid;console.log("Signed in anonymously with UID:", userId);updatePageMetrics('views');}).catch((error) => {console.error("Error signing in anonymously:", error);});document.addEventListener('DOMContentLoaded', () => {const trackableElements = document.querySelectorAll('a, .track-link-click');trackableElements.forEach(element => {element.addEventListener('click', () => {updatePageMetrics('clicks');});});const leadForm = document.getElementById('lead-form');const submitBtn = document.getElementById('submit-btn');const formContainer = leadForm ? leadForm.parentElement : null;if (leadForm && submitBtn && formContainer) {leadForm.addEventListener('submit', async (e) => {e.preventDefault();if (!userId) {alert("Authentication not ready. Please try again in a moment.");console.error("User ID is null, cannot submit form.");return;}submitBtn.textContent = "Sending...";submitBtn.disabled = true;submitBtn.classList.add('opacity-50', 'cursor-not-allowed');const data = {userId: userId,timestamp: firebase.firestore.FieldValue.serverTimestamp()};leadForm.querySelectorAll('input, select, textarea').forEach(field => {if (field.name) {data[field.name] = field.value;}});try {await db.collection("pages").doc(PAGE_DOC_ID).collection("leads").add(data);console.log("Lead submitted successfully!");updatePageMetrics('leads');leadForm.style.display = 'none';const successMessageDiv = document.createElement('div');successMessageDiv.className = 'text-center p-8 bg-green-100 text-green-800 rounded-lg shadow-md';successMessageDiv.innerHTML = `<h3 class="text-2xl font-bold mb-4">Thank You!</h3><p class="text-lg">Your consultation request has been received. We'll be in touch shortly!</p>`;formContainer.appendChild(successMessageDiv);} catch (error) {console.error("Error submitting lead:", error);alert("There was an error submitting your request. Please try again.");submitBtn.textContent = "Book Free Consultation";submitBtn.disabled = false;submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');}});}});}